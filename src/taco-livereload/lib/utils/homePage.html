<html>
    <head>
        <title>CORDOVA-PLUGIN-LIVERELOAD</title>
        <style>
            #loading, #error {
                display: none;
            }
        </style>
    </head>    
    <body>
        <h3>CORDOVA-PLUGIN-LIVERELOAD</h3>
        <div id="error">There was an error connecting to the BrowserSync server.
            <br />
            <br />Try using the<b><a>'tunnel'</a></b>option as in:
            <br />
            <b>`cordova run android -- --livereload --tunnel`</b>
            <br />
            <br />For more information,
            <b>
                <a href="https://github.com/omefire/cordova-plugin-livereload#options">check the documentation</a>
            </b>
            <br />
            <br />
        </div>
        <div id="loading">...Loading your app, Please wait...</div>
    </body>
    <script type="text/javascript">
        function connectToBrowserSyncServer(server_url) {
            var req = new XMLHttpRequest();			
        			
            // Use `Math.random()` to prevent the caching of the server_url by the browser
            req.open('GET', server_url + '?' + Math.random());
        			
            req.onreadystatechange = function(aEvt) {
                if (req.readyState == 4) {
                    if (req.status == 200) {
                        return requestCompletedWithSuccess();
                    }
                    return requestFailed();
                }
            };
            req.send();
        }
        			
        function requestCompletedWithSuccess() {
            document.getElementById('loading').style.display = 'block';
                setTimeout(function() {
                    window.location.href = '__SERVER_URL__';
            }, 2000);
        }
        
        function requestFailed() {
            document.getElementById('error').style.display = 'block'; 
        }
        		
        // __SERVER_URL__ gets replaced by the real server url right before this file gets deployed to a device/emulator
        var SERVER_URL = '__SERVER_URL__'; 		
        connectToBrowserSyncServer(SERVER_URL);
    </script>
</html>